<!doctype html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="icon" type="image/x-icon" href="../../../static/favicon.ico?h=e38ef9dd">
<link rel="stylesheet" href="../../../static/lib/normalize.css?h=ece571f3">
<link rel="stylesheet" href="../../../static/lib/skeleton.css?h=1fd77917">
<link rel="stylesheet" href="../../../static/style.css?h=5db9e889">
<link rel="stylesheet" href="../../../static/lib/medium-editor/medium-editor.min.css?h=17e98ac9">
<link rel="stylesheet" href="../../../static/fonts/anonymous-pro/anonymous-pro.css?h=7b3d4039">
<link rel="stylesheet" href="../../../static/fonts/fa/css/font-awesome.min.css?h=512c7d79">
<link rel="stylesheet" href="../../../static/fonts/ionicons/css/ionicons.min.css?h=f0459300">
<link rel="stylesheet" href="../../../static/fonts/source-sans-pro/source-sans-pro.css?h=eef2e813">

<!-- <script src="../../../static/lib/clipboard.min.js?h=64efc85d"></script> -->
<script src="../../../static/lib/jquery-2.2.1.min.js?h=7cb05e3d"></script>
<script src="../../../static/lib/marked.js?h=acaa528b"></script>
<script src="../../../static/lib/MooTools-Core-1.6.0.js?h=f829fe22"></script>
<script src="../../../static/lib/sprintf.js?h=f8d59971"></script>
<script src="../../../static/lib/medium-editor/medium-editor.min.js?h=d2c3e1bb"></script>
<script src="../../../static/lib/me-markdown.standalone.min.js?h=f8bd91a7"></script>
<script src="../../../static/lr-notebook.js?h=9fb07e66"></script>


<title></title>
<body>
  <header>
    <h1><i class="fa fa-sticky-note-o"></i> nb-fischbach</h1>
    <nav>
      <ul class="nav navbar-nav">
        <li><a  href="../../../">Welcome</a></li>
        
          <li><a  class="active" href="../../../projects/">Projects</a></li>
        
          <li><a  href="../../../calendar/">Calendar</a></li>
        
          <li><a  href="../../../meetings/">Meetings</a></li>
        
          <li><a  href="../../../about/">About</a></li>
        
          <li><a  href="../../../shared/">Shared</a></li>
        
      </ul>
    </nav>
    
  </header>

  <iframe width="0" height="0" border="0" name="frame" style="border-style: none;"></iframe>

  <div class="page">
    
<h2 style="display: inline;"><a class="orange" href="../../../projects/CAS/">CAS/</a></h2><br>
<form target="frame" action="/admin/api/browsefs" method="post">
  <input type="hidden" name="path" value="/projects/CAS/2017-05-23">
  <input type="image" src=../../../static/images/link.png>
</form>
<h2 class="lightblue" style="display: inline;">Pruning and Excluding Terms from Heatmap</h2> <span style="float:right;" class="midgray">2017-05-23</span> 
<hr>


<h5 style="float:left;">Attachments:</h5>


<div class="row">
  <div class="one column"></div>
  <div class="two columns"><!-- Attachments: --></div>
<div class="nine columns">
    
    
    
        <a class="green" href="../../../projects/CAS/2017-05-23/Cas9_REC_excluded.html">Cas9_REC_excluded.html</a>
        
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
 
 
  
  
  
,
    
        <a class="green" href="../../../projects/CAS/2017-05-23/Cas9_REC_heatmap.html">Cas9_REC_heatmap.html</a>
        
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
 
 
  
  
  
,
    
        <a class="green" href="../../../projects/CAS/2017-05-23/Cas9_REC_pruned.html">Cas9_REC_pruned.html</a>
        
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
 
 
  
  
  

    
  </div>
</div>


<hr>





<div id="entry">
    <h2>CAS 05-23-17</h2>
<p>First thing to do is to reroute the html output of the bokeh plot function. I want one html output per pfam term in the appropriate pfam term folder.</p>
<p>Also want to add a legend to the bokeh figure. It's been pretty straightforward. Just need to add legend keyword when calling rectFig. Going to add a legend column to the source DataFrame.</p>
<p>I also need to add in the possibility of having more than 11 (12?) key terms that I want to reserve colors for. The way it's working right now, if it's more than that (the colorbrewer maximum), it's going to crash. But first...need to finish the legend.</p>
<p>Got the legend working alright. Had to add a legend list to the data_dict, but that wasn't a huge deal. Just maps everything into the dict as either one of the key terms or 'other'.</p>
<p>I'm going to comment out the part of the code that doesn't regenerate the data_dict and dataframe everytime the plot gets made. It doesn't take any serious amount of time and I keep updating what goes into the df and data_dict so I think it's worth regenerating it all the time.</p>
<h2>Pruning Key Terms</h2>
<p>I wrote a function in the analyze.py script called prune_key_terms(pfam_target). It goes in and only keeps the lines from the loaded DataFrame that have less than a certain amount of found key terms. The idea here was to see if there's any sequences that have Cas9_REC and don't have the others. It looks like maybe there is...probably worth checking out tomorrow. I'll include the resulting plot here.</p>
<p>Also...I want to make the coloring consistent. How can I do that given the current way color mappings are generated? Also forgot to fix the bug where more than 11 (12?) key terms will crash everything. The way I'm going to keep the color mapping consistent is by sorting the key terms alphabetically. That way at least when I have the same number of key terms, it should map to the same color. Dunno about when I have different number of key terms...but that's not a huge deal I think.</p>
<p>Wrote an exclude key terms as well to look at sequences without excluded terms.</p>
<p>Note that I now have separate .txt files for excluding, pruning, and coloring in the all-sequences map (key_terms.txt).</p>

</div>






<pre style="display:none;" class="markdown"></pre>

<script>
  function renderRightAsMarkdown() {
      var right = document.getElementsByClassName("right");
      for (var i=0; i<right.length; i++) {
          src = right[i].innerHTML
          right[i].innerHTML = marked(src);
      }
  }
  renderRightAsMarkdown();
</script>




<script>

// Disable clipboard stuff for now
// var pre = document.getElementsByTagName('pre');
// for (var i = 0; i < pre.length; i++) {
//   var button = document.createElement('button');
//   button.className = 'btn fa fa-copy';
//   pre[i].appendChild(button);
// }

// var clipboard = new Clipboard('.btn', {
//   target: function(trigger) {return trigger.previousElementSibling;}
// });

// function showSuccess(elem){elem.setAttribute('class','btn fa fa-check');}
// function sleep (time) {return new Promise((resolve) => setTimeout(resolve, time));}
// clipboard.on('success',function(e){
//   showSuccess(e.trigger);
//   sleep(350).then(() => {e.clearSelection();
//     e.trigger.setAttribute('class','btn fa fa-copy');})
// });

// Experimental direct editing

// var paragraphs = $$("#entry>p");
// var lastEl = paragraphs.getLast();
// var path = '/projects/CAS/2017-05-23';

// paragraphs.each(function(el) {
//   var dropArea = new Element('div', {'class':'right droparea',
//                                      'ondrop':'drop(event, path)',
//                                      'ondragover':'dragover_handler(event)'
//                                      });
//   var next = el.getNext();
//   if (!!next && !next.hasClass('right')) {
//     droptext = new Element('div', {'id':'targetString',
//                                    styles:{display: 'none'},
//                                    'html':el.get('html')
//                                   });
//     droptext.inject(dropArea);
//     dropArea.inject(el, 'after');
//   }
// });

// var rightimgs = $$("img.thumb");
// rightimgs.each(function(el) {
//   var button = document.createElement('button');
//   button.className = 'btn fa fa-window-close';
//   el.appendChild(button);
// });

// var markDownEl = document.querySelector(".markdown");

// new MediumEditor($$("#entry>p"), {
//     extensions: {markdown: new MeMarkdown(function (md) {markDownEl.textContent = md;})},
//     toolbar: {
//       allowMultiParagraphSelection: false,
//       buttons: ['bold', 'italic', 'underline']
//     },
//     disableReturn: true,
//     disableDoubleReturn: true,
//     disableExtraSpaces: true,
//     paste: {
//         forcePlainText: true,
//         cleanPastedHTML: true
//     }
// });

</script>

<a href="slides" id="play-slides-link"><i class="fa fa-play" aria-hidden="true"></i></a>


  </div>

  <footer>
    &copy; 2016. Made with <a target="_new" href="http://bionano.ucsf.edu/"><i class="fa fa-flask"></i></a> in SF.
  </footer>

</body>
