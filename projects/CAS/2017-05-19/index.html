<!doctype html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="icon" type="image/x-icon" href="../../../static/favicon.ico?h=e38ef9dd">
<link rel="stylesheet" href="../../../static/lib/normalize.css?h=ece571f3">
<link rel="stylesheet" href="../../../static/lib/skeleton.css?h=1fd77917">
<link rel="stylesheet" href="../../../static/style.css?h=5db9e889">
<link rel="stylesheet" href="../../../static/lib/medium-editor/medium-editor.min.css?h=17e98ac9">
<link rel="stylesheet" href="../../../static/fonts/anonymous-pro/anonymous-pro.css?h=7b3d4039">
<link rel="stylesheet" href="../../../static/fonts/fa/css/font-awesome.min.css?h=512c7d79">
<link rel="stylesheet" href="../../../static/fonts/ionicons/css/ionicons.min.css?h=f0459300">
<link rel="stylesheet" href="../../../static/fonts/source-sans-pro/source-sans-pro.css?h=eef2e813">

<!-- <script src="../../../static/lib/clipboard.min.js?h=64efc85d"></script> -->
<script src="../../../static/lib/jquery-2.2.1.min.js?h=7cb05e3d"></script>
<script src="../../../static/lib/marked.js?h=acaa528b"></script>
<script src="../../../static/lib/MooTools-Core-1.6.0.js?h=f829fe22"></script>
<script src="../../../static/lib/sprintf.js?h=f8d59971"></script>
<script src="../../../static/lib/medium-editor/medium-editor.min.js?h=d2c3e1bb"></script>
<script src="../../../static/lib/me-markdown.standalone.min.js?h=f8bd91a7"></script>
<script src="../../../static/lr-notebook.js?h=9fb07e66"></script>


<title></title>
<body>
  <header>
    <h1><i class="fa fa-sticky-note-o"></i> nb-fischbach</h1>
    <nav>
      <ul class="nav navbar-nav">
        <li><a  href="../../../">Welcome</a></li>
        
          <li><a  class="active" href="../../../projects/">Projects</a></li>
        
          <li><a  href="../../../calendar/">Calendar</a></li>
        
          <li><a  href="../../../meetings/">Meetings</a></li>
        
          <li><a  href="../../../about/">About</a></li>
        
          <li><a  href="../../../shared/">Shared</a></li>
        
      </ul>
    </nav>
    
  </header>

  <iframe width="0" height="0" border="0" name="frame" style="border-style: none;"></iframe>

  <div class="page">
    
<h2 style="display: inline;"><a class="orange" href="../../../projects/CAS/">CAS/</a></h2><br>
<form target="frame" action="/admin/api/browsefs" method="post">
  <input type="hidden" name="path" value="/projects/CAS/2017-05-19">
  <input type="image" src=../../../static/images/link.png>
</form>
<h2 class="lightblue" style="display: inline;">Cas9_REC PFAM Results Grid</h2> <span style="float:right;" class="midgray">2017-05-19</span> 
<hr>


<h5 style="float:left;">Attachments:</h5>


<div class="row">
  <div class="one column"></div>
  <div class="two columns"><!-- Attachments: --></div>
<div class="nine columns">
    
      
        <a href="../../../projects/CAS/2017-05-19/first_pass.png"><img id="first_pass.png" draggable="true" ondragstart="drag(event)" ondragend="dragend(event)" src="../../../projects/CAS/2017-05-19/first_pass@50x50.png"></a>
      
    
    <br/>
    
  </div>
</div>


<hr>





<div id="entry">
    <h2>CAS 5-19-17</h2>
<p>I've gotten the block and hits objects written as well as the pfam object. I've spat out the Cas9_REC data and now need to move into the Arrower code and port in the blocks.out file.</p>
<p>Writing this down, it seems like maybe I don't have to go into the arrower code and that might take a little bit of time. I think instead, what I can do is maybe make a heatmap type thing?</p>
<p>More of a grid that would look something like this:</p>
<table>
<thead><tr>
<th>pfam_term</th>
<th>pfam_term</th>
<th>HIT TERM</th>
<th>pfam_term</th>
<th>...</th>
</tr>
</thead>
<tbody>
<tr>
<td>pfam_term</td>
<td>pfam_term</td>
<td>HIT TERM</td>
<td>pfam_term</td>
<td>...</td>
</tr>
<tr>
<td>pfam_term</td>
<td>pfam_term</td>
<td>HIT TERM</td>
<td>pfam_term</td>
<td>...</td>
</tr>
<tr>
<td>pfam_term</td>
<td>pfam_term</td>
<td>HIT TERM</td>
<td>pfam_term</td>
<td>...</td>
</tr>
<tr>
<td>pfam_term</td>
<td>pfam_term</td>
<td>HIT TERM</td>
<td>pfam_term</td>
<td>...</td>
</tr>
</tbody>
</table>
<p>The adjacent pfam terms can be colored and sorted for visualization</p>
<p>Would this make sense to do with Bokeh? I already have something of a heatmap code up and running and could make some sense to use it...</p>
<p>If I can integrate the generated Bokeh html into the lektor notebook then it might be worth it.</p>
<h2>Adding Tab to Lektor Notebook</h2>
<p>If I just add a folder in the content directory of the lektor notebook, nothing seems to get added. If I go into the templates folder, I think it's because I need to add something to the actual layout .html file.</p>
<p>I've created a backup copy of the layout.html file and modified the existing one. I've added a tab called data that should link to ./content/data in the notebook file structure.</p>
<p>I copied over the contents.lr file from the projects page to the data folder and it looks to be fine in terms of the linking. The content.lr file is just linking to the projects model. So I think I may just have to create a new type of model for this page and link it to the Bokeh html file.</p>
<p>Just changed the new tab name to 'results'</p>
<p>I'm creating a new model called 'results.ini' (copied the projects.ini file and renamed it). I'm giving it a child model like the projects.ini model has the project.ini child. Calling it result.ini</p>
<p>I've also created corresponding results.html and result.html files. 
I'm updated the results.html file but not seing updates on the rendered results page. I'm going to put this down for now and come back to it when I have more data to be putting in there anyways.</p>
<h2>Heatmap data (heatmap.py)</h2>
<p>Back to the visualization. I'm making a new scipt called heatmap.py that will render a grid/heatmap as described above.</p>
<p>I have pfam terms now concatenated into a single numpy array with dimensions (162, 51). I need to have a color mapping now. I think the way to do it is to count the number of unique pfam terms in the concatenated array and assign each one a unique int (do I need this or can I just straight to assigning each one a unique color?). I'll try assigning each one a unique integer first and spitting out a heatmap.</p>
<p>This works fine, but the heatmap is pretty unreadable (first_pass.png).</p>
<p>Jakub suggested just coloring in the 'priveleged' cas terms. e.g. cas1/2 and the nuclease terms. The rest of the random sort of colors aren't that important.</p>
<h2>Coloring Key Terms</h2>
<p>I think the best way to do that will be to associate 'priveleged' terms with each target pfam as a separate txt file in the data folder as blocks.out.</p>
<p>I'm creating a file in the data directory just called 'key_terms'. Each line in this file is going to be a pfam term (can be easily edited) and every pfam term in this file will get its own color. Otherwise, no colors for the rest of the terms.</p>
<p>It sounds like I'll have to do a little bit of data processing so I think that it makes sense to make a separate data processing script. I'm calling it data_prep.py. Going to copy over most of the heatmap code I have so far, minus the plotting part.</p>
<p>I need to define a custom colormap for this data. But looking over it...I'm starting to think that it actually might just be easier to repurpose the Bokeh code that I have setup for HSV heatmap. It's pretty hard to be directly mapping colors to values like I want and I know that I can do that in maybe a more straightfoward way using Bokeh.</p>
<p>I just tried to run HSV_Bokeh.py and it is no longer finding data_sourc.pkl. I started rearranging the HSV file structure but didn't finish doing that. I think it's worth it to take a little bit of time to finish that out to the point where HSV_bokeh is working again. And that way I can take a look at the HSV_Bokeh source code too.</p>

</div>






<pre style="display:none;" class="markdown"></pre>

<script>
  function renderRightAsMarkdown() {
      var right = document.getElementsByClassName("right");
      for (var i=0; i<right.length; i++) {
          src = right[i].innerHTML
          right[i].innerHTML = marked(src);
      }
  }
  renderRightAsMarkdown();
</script>




<script>

// Disable clipboard stuff for now
// var pre = document.getElementsByTagName('pre');
// for (var i = 0; i < pre.length; i++) {
//   var button = document.createElement('button');
//   button.className = 'btn fa fa-copy';
//   pre[i].appendChild(button);
// }

// var clipboard = new Clipboard('.btn', {
//   target: function(trigger) {return trigger.previousElementSibling;}
// });

// function showSuccess(elem){elem.setAttribute('class','btn fa fa-check');}
// function sleep (time) {return new Promise((resolve) => setTimeout(resolve, time));}
// clipboard.on('success',function(e){
//   showSuccess(e.trigger);
//   sleep(350).then(() => {e.clearSelection();
//     e.trigger.setAttribute('class','btn fa fa-copy');})
// });

// Experimental direct editing

// var paragraphs = $$("#entry>p");
// var lastEl = paragraphs.getLast();
// var path = '/projects/CAS/2017-05-19';

// paragraphs.each(function(el) {
//   var dropArea = new Element('div', {'class':'right droparea',
//                                      'ondrop':'drop(event, path)',
//                                      'ondragover':'dragover_handler(event)'
//                                      });
//   var next = el.getNext();
//   if (!!next && !next.hasClass('right')) {
//     droptext = new Element('div', {'id':'targetString',
//                                    styles:{display: 'none'},
//                                    'html':el.get('html')
//                                   });
//     droptext.inject(dropArea);
//     dropArea.inject(el, 'after');
//   }
// });

// var rightimgs = $$("img.thumb");
// rightimgs.each(function(el) {
//   var button = document.createElement('button');
//   button.className = 'btn fa fa-window-close';
//   el.appendChild(button);
// });

// var markDownEl = document.querySelector(".markdown");

// new MediumEditor($$("#entry>p"), {
//     extensions: {markdown: new MeMarkdown(function (md) {markDownEl.textContent = md;})},
//     toolbar: {
//       allowMultiParagraphSelection: false,
//       buttons: ['bold', 'italic', 'underline']
//     },
//     disableReturn: true,
//     disableDoubleReturn: true,
//     disableExtraSpaces: true,
//     paste: {
//         forcePlainText: true,
//         cleanPastedHTML: true
//     }
// });

</script>

<a href="slides" id="play-slides-link"><i class="fa fa-play" aria-hidden="true"></i></a>


  </div>

  <footer>
    &copy; 2016. Made with <a target="_new" href="http://bionano.ucsf.edu/"><i class="fa fa-hand-lizard-o"></i></a> in SF.
  </footer>

</body>
